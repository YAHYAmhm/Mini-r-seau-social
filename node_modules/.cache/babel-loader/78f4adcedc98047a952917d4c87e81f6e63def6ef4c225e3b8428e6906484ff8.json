{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api from '../../services/api';\nexport const fetchPosts = createAsyncThunk('posts/fetchPosts', async () => {\n  const response = await api.get('/posts?_expand=user');\n  return response.data;\n});\nexport const createPost = createAsyncThunk('posts/createPost', async newPost => {\n  const response = await api.post('/posts', newPost);\n  return response.data;\n});\nexport const updatePost = createAsyncThunk('posts/updatePost', async ({\n  id,\n  data\n}) => {\n  const response = await api.patch(`/posts/${id}`, data);\n  return response.data;\n});\nexport const deletePost = createAsyncThunk('posts/deletePost', async id => {\n  await api.delete(`/posts/${id}`);\n  return id;\n});\nexport const toggleLike = createAsyncThunk('posts/toggleLike', async ({\n  postId,\n  userId\n}, {\n  getState\n}) => {\n  const state = getState();\n  const post = state.posts.items.find(p => p.id === postId);\n  let newLikes = [...post.likes];\n  if (newLikes.includes(userId)) {\n    newLikes = newLikes.filter(id => id !== userId);\n  } else {\n    newLikes.push(userId);\n  }\n  const response = await api.patch(`/posts/${postId}`, {\n    likes: newLikes\n  });\n  return response.data;\n});\nconst postsSlice = createSlice({\n  name: 'posts',\n  initialState: {\n    items: [],\n    status: 'idle',\n    error: null\n  },\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(fetchPosts.fulfilled, (state, action) => {\n      state.status = 'succeeded';\n      state.items = action.payload;\n    }).addCase(createPost.fulfilled, (state, action) => {\n      state.items.unshift(action.payload);\n    }).addCase(updatePost.fulfilled, (state, action) => {\n      const index = state.items.findIndex(p => p.id === action.payload.id);\n      if (index !== -1) state.items[index] = action.payload;\n    }).addCase(deletePost.fulfilled, (state, action) => {\n      state.items = state.items.filter(p => p.id !== action.payload);\n    }).addCase(toggleLike.fulfilled, (state, action) => {\n      const index = state.items.findIndex(p => p.id === action.payload.id);\n      if (index !== -1) state.items[index].likes = action.payload.likes;\n    });\n  }\n});\n\n// Selectors\nexport const selectAllPosts = state => state.posts.items;\nexport const selectPostsByUser = (state, userId) => state.posts.items.filter(post => post.authorId === userId);\nexport const selectPostsByHashtag = (state, hashtag) => state.posts.items.filter(post => post.hashtags && post.hashtags.includes(hashtag));\nexport default postsSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","fetchPosts","response","get","data","createPost","newPost","post","updatePost","id","patch","deletePost","delete","toggleLike","postId","userId","getState","state","posts","items","find","p","newLikes","likes","includes","filter","push","postsSlice","name","initialState","status","error","reducers","extraReducers","builder","addCase","fulfilled","action","payload","unshift","index","findIndex","selectAllPosts","selectPostsByUser","authorId","selectPostsByHashtag","hashtag","hashtags","reducer"],"sources":["C:/Users/pc/Documents/03-12-24/03-12-24/src/store/slices/postsSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport api from '../../services/api';\r\n\r\nexport const fetchPosts = createAsyncThunk('posts/fetchPosts', async () => {\r\n    const response = await api.get('/posts?_expand=user');\r\n    return response.data;\r\n});\r\n\r\nexport const createPost = createAsyncThunk('posts/createPost', async (newPost) => {\r\n    const response = await api.post('/posts', newPost);\r\n    return response.data;\r\n});\r\n\r\nexport const updatePost = createAsyncThunk('posts/updatePost', async ({ id, data }) => {\r\n    const response = await api.patch(`/posts/${id}`, data);\r\n    return response.data;\r\n});\r\n\r\nexport const deletePost = createAsyncThunk('posts/deletePost', async (id) => {\r\n    await api.delete(`/posts/${id}`);\r\n    return id;\r\n});\r\n\r\nexport const toggleLike = createAsyncThunk('posts/toggleLike', async ({ postId, userId }, { getState }) => {\r\n    const state = getState();\r\n    const post = state.posts.items.find(p => p.id === postId);\r\n    let newLikes = [...post.likes];\r\n\r\n    if (newLikes.includes(userId)) {\r\n        newLikes = newLikes.filter(id => id !== userId);\r\n    } else {\r\n        newLikes.push(userId);\r\n    }\r\n\r\n    const response = await api.patch(`/posts/${postId}`, { likes: newLikes });\r\n    return response.data;\r\n});\r\n\r\nconst postsSlice = createSlice({\r\n    name: 'posts',\r\n    initialState: {\r\n        items: [],\r\n        status: 'idle',\r\n        error: null,\r\n    },\r\n    reducers: {},\r\n    extraReducers: (builder) => {\r\n        builder\r\n            .addCase(fetchPosts.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                state.items = action.payload;\r\n            })\r\n            .addCase(createPost.fulfilled, (state, action) => {\r\n                state.items.unshift(action.payload);\r\n            })\r\n            .addCase(updatePost.fulfilled, (state, action) => {\r\n                const index = state.items.findIndex(p => p.id === action.payload.id);\r\n                if (index !== -1) state.items[index] = action.payload;\r\n            })\r\n            .addCase(deletePost.fulfilled, (state, action) => {\r\n                state.items = state.items.filter(p => p.id !== action.payload);\r\n            })\r\n            .addCase(toggleLike.fulfilled, (state, action) => {\r\n                const index = state.items.findIndex(p => p.id === action.payload.id);\r\n                if (index !== -1) state.items[index].likes = action.payload.likes;\r\n            });\r\n    },\r\n});\r\n\r\n// Selectors\r\nexport const selectAllPosts = (state) => state.posts.items;\r\nexport const selectPostsByUser = (state, userId) => state.posts.items.filter(post => post.authorId === userId);\r\nexport const selectPostsByHashtag = (state, hashtag) =>\r\n    state.posts.items.filter(post => post.hashtags && post.hashtags.includes(hashtag));\r\n\r\nexport default postsSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}